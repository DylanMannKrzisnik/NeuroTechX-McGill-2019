<html>
  <head>
    <Title> Training Dashboard </Title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.4/css/bulma.min.css">
    <script src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.0/d3.min.js' charset='utf-8'></script>
    <!-- <script src="./assets/js/epoch.js"></script> -->
    <script src="./assets/js/data.js"></script>
    <!-- <link rel="stylesheet" type="text/css" href="./assets/css/epoch.min.css"> -->
    <link rel="stylesheet" href="./assets/css/style.css">
    <script src="./assets/js/control.js"></script>
    <script src="/assets/js/socket.io.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/smoothie/1.34.0/smoothie.min.js"></script>





      <script>
        var socket = io();
    </script>
  </head>
  <body>
    <nav class="navbar" role="navigation" aria-label="main navigation">
      <div class="navbar-brand">
        <div class="navbar-item">
          <div class="tabs is-toggle is-fullwidth" id="tabs">
            <ul>
              <li class="is-active" data-tab="1">
                <a>
                  <span class="icon is-small"><i class="fas fa-brain"></i></span>
                  <span>Training Dashboard</span>
                </a>
              </li>
              <li data-tab="2">
                <a>
                  <span class="icon is-small"><i class="fab fa-accessible-icon"></i></span>
                  <span>Other Dashboard</span>
                </a>
              </li>
            </ul>
          </div>
        </div>
        <img class="logo-image" src="assets/img/mcgill-neurotech.png" alt="McGill Neurotech">
      </div>
    </nav>

  <section class="section">
    <div id="tab-content">
      <div class="is-active" data-content="1">
        <div class="container">
          <div class="overhead">
              <h1 class="title">
                Training Dashboard
              </h1>
              <form class="trial">
                Trial Name:
                <input type="text" name="trial-input"><br>
              </form>
          </div>
              <div class="graphview">
                <article class="media" id="media-sensor1">
                  <figure class="media-left">
                    <strong>
                    Sensor 1:

                    </strong>
                  </figure>
                  <div class="media-content">
                    <div class="content">
                    <canvas id="smoothie-chart" width="800" height="100">
                      <div id="sensor1" class="epoch category10" style="height: 100px;"></div>
                    </div>
                  </div>
                </article>
                <!--
                <article class="media" id="media-sensor2">
                  <figure class="media-left">
                    <strong>
                    <a> Sensor 2:
                      </a>
                    </strong>
                  </figure>
                  <div class="media-content">
                    <div class="content">
                      <div id="sensor2" class="epoch category10" style="height: 100px;"></div>
                    </div>
                  </div>
                </article>
                <article class="media" id="media-sensor3">
                  <figure class="media-left">
                    <strong>
                    <a> Sensor 3:
                      </a>
                    </strong>
                  </figure>
                  <div class="media-content">
                    <div class="content">
                      <div id="sensor3" class="epoch category10" style="height: 100px;"></div>
                    </div>
                  </div>
                </article>
                <article class="media" id="media-sensor4">
                  <figure class="media-left">
                    <strong>
                    <a> Sensor 4:
                      </a>
                    </strong>
                  </figure>
                  <div class="media-content">
                    <div class="content">
                      <div id="sensor4" class="epoch category10" style="height: 100px;"></div>
                    </div>
                  </div>
                </article>
                <article class="media" id="media-sensor5">
                  <figure class="media-left">
                    <strong>
                    <a> Sensor 5:
                      </a>
                    </strong>
                  </figure>
                  <div class="media-content">
                    <div class="content">
                      <div id="sensor5" class="epoch category10" style="height: 100px;"></div>
                    </div>
                  </div>
                </article>
                <article class="media" id="media-sensor6">
                  <figure class="media-left">
                    <strong>
                    <a> Sensor 6:
                      </a>
                    </strong>
                  </figure>
                  <div class="media-content">
                    <div class="content">
                      <div id="sensor6" class="epoch category10" style="height: 100px;"></div>
                    </div>
                  </div>
                </article>
                <article class="media" id="media-sensor7">
                  <figure class="media-left">
                    <strong>
                    <a> Sensor 7:
                      </a>
                    </strong>
                  </figure>
                  <div class="media-content">
                    <div class="content">
                      <div id="sensor7" class="epoch category10" style="height: 100px;"></div>
                    </div>
                  </div>
                </article>
                <article class="media" id="media-sensor8">
                  <figure class="media-left">
                    <strong>
                    <a> Sensor 8:
                      </a>
                    </strong>
                  </figure>
                  <div class="media-content">
                    <div class="content">
                      <div id="sensor8" class="epoch category10" style="height: 100px;"></div>
                    </div>
                  </div>
                </article> -->
              </div>
              <div class="graph-controls">
                <label for="scales">Sensor 1:</label>
                <input type="checkbox" id="sensor1" name="sensor1" checked>
                <label for="scales">Sensor 2:</label>
                <input type="checkbox" id="sensor2" name="sensor2" checked>
                <label for="scales">Sensor 3:</label>
                <input type="checkbox" id="sensor3" name="sensor3" checked>
                <label for="scales">Sensor 4:</label>
                <input type="checkbox" id="sensor4" name="sensor4" checked>
                <label for="scales">Sensor 5:</label>
                <input type="checkbox" id="sensor5" name="sensor5" checked>
                <label for="scales">Sensor 6:</label>
                <input type="checkbox" id="sensor6" name="sensor6" checked>
                <label for="scales">Sensor 7:</label>
                <input type="checkbox" id="sensor7" name="sensor7" checked>
                <label for="scales">Sensor 8:</label>
                <input type="checkbox" id="sensor8" name="sensor8" checked>

              </div>
              <div class="container" id="controls">

                <div class="commands">
                    <div class="with-unit">
                      <input type="text" class="timer" value="0"></input>
                  </div>
                  <button class="selection imagery direction-left">Left</button>
                  <button class="selection imagery direction-rest">Rest</button>
                  <button class="selection imagery direction-right">Right</button>
                  <button class="selection loop">
                    <i class="fas fa-retweet"></i>
                  </button>
                  <div class="range-slider">
                    <input class="input-range" type="range" value="0" min="0" max="100" step="1" >
                  </div>

                </div>


              </div>
        </div>

      </div>
      <div data-content="2">
        <div class="container">
              <h1 class="title">
                Other Dashboard
              </h1>
        </div>
      </div>
    </div>

  </section>
  <script>
    function getTimeValue() {
      var dateBuffer = new Date();
      var Time = dateBuffer.getTime();
      return Time;
    }

    var chart = new SmoothieChart({grid:{fillStyle:'transparent'},
                                  labels:{fillStyle:'transparent'}});
    chart.streamTo(document.getElementById('smoothie-chart'), 500);

    var line = new TimeSeries();
    let timeElapsed = new Date().getTime()
    socket.on('timeseries', function(timeseries) {
        // console.log(channelOne.data);
        line.append(new Date().getTime(), timeseries['eeg']['data'][0]);
        // if (counter == 10) {
          // let newData = (new Date().getTime(), timeseries['eeg']['data'][0]);
          // console.log(timeseries['eeg']['data'][0])
          // console.log(counter)
          if (new Date().getTime() -  timeElapsed > 550){
              chart.addTimeSeries(line, {lineWidth:2, strokeStyle:'#6834c8'});
              timeElapsed = new Date().getTime();
              line = new TimeSeries();
          }

            // counter = 0;
        // } else {
            // ends with 0
            // counter++;
        // }
        // console.log(timeseries['eeg']['data'][0]);

        // console.log(channelOne.data + " and time: " + getTimeValue());
        // sensorChart1.push(newData);
    });

    // setInterval(function() {
    //   line.append(new Date().getTime(), Math.random())
    // }, 100);
    //
    // chart.addTimeSeries(line, {lineWidth:2, strokeStyle:'#6834c8'});



  //
  //
  // var sensorChart1 = $('#sensor1').epoch({
  //     type: 'time.area',
  //     data: lineChartData,
  //     axes: ['left', 'right', 'bottom']
  // });
  // let counter = 0;
  // let previousTime = 0;
  </script>
  </body>

</html>
